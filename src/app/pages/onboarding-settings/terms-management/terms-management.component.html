<div class="terms-management">
    <div class="action-bar">
        <button 
            pButton 
            label="Create New Terms" 
            icon="pi pi-plus" 
            class="p-button-primary"
            (click)="openNewDialog()">
        </button>
    </div>

    <p-table 
        [value]="terms()" 
        [loading]="loading()"
        styleClass="p-datatable-gridlines"
        [paginator]="true"
        [rows]="10"
        [rowsPerPageOptions]="[5, 10, 20]"
        responsiveLayout="scroll">
        
        <ng-template pTemplate="header">
            <tr>
                <th>Title</th>
                <th>Version</th>
                <th>Status</th>
                <th>Effective Date</th>
                <th>Expiry Date</th>
                <th style="width: 150px">Actions</th>
            </tr>
        </ng-template>
        
        <ng-template pTemplate="body" let-term>
            <tr>
                <td>{{ term.title }}</td>
                <td>{{ term.version }}</td>
                <td>
                    <span [class]="term.isActive ? 'status-badge active' : 'status-badge inactive'">
                        {{ term.isActive ? 'Active' : 'Inactive' }}
                    </span>
                </td>
                <td>{{ formatDate(term.effectiveDate) }}</td>
                <td>{{ formatDate(term.expiryDate) }}</td>
                <td>
                    <button 
                        pButton 
                        icon="pi pi-eye" 
                        class="p-button-text p-button-info"
                        pTooltip="View"
                        (click)="editTerm(term)">
                    </button>
                </td>
            </tr>
        </ng-template>
        
        <ng-template pTemplate="emptymessage">
            <tr>
                <td colspan="6" class="text-center">No terms and conditions found</td>
            </tr>
        </ng-template>
    </p-table>
</div>

<p-dialog 
    [(visible)]="showDialog" 
    [header]="isEditMode() ? 'View Terms & Conditions' : 'Create Terms & Conditions'"
    [modal]="true" 
    [style]="{width: '800px'}"
    [draggable]="false"
    [resizable]="false">
    
    <div class="dialog-content">
        <div class="form-grid">
            <div class="form-field">
                <label for="title">Title *</label>
                <input 
                    id="title" 
                    type="text" 
                    pInputText 
                    [(ngModel)]="currentTerm.title"
                    [disabled]="isEditMode()"
                    placeholder="Enter title">
            </div>

            <div class="form-field">
                <label for="version">Version *</label>
                <input 
                    id="version" 
                    type="text" 
                    pInputText 
                    [(ngModel)]="currentTerm.version"
                    [disabled]="isEditMode()"
                    placeholder="e.g., 1.0">
            </div>

            <div class="form-field full-width">
                <label for="content">Content *</label>
                <p-editor 
                    [(ngModel)]="currentTerm.content" 
                    [style]="{'height':'320px'}"
                    [readonly]="isEditMode()">
                    <ng-template pTemplate="header">
                        <span class="ql-formats">
                            <button type="button" class="ql-bold" aria-label="Bold"></button>
                            <button type="button" class="ql-italic" aria-label="Italic"></button>
                            <button type="button" class="ql-underline" aria-label="Underline"></button>
                        </span>
                        <span class="ql-formats">
                            <button type="button" class="ql-list" value="ordered"></button>
                            <button type="button" class="ql-list" value="bullet"></button>
                        </span>
                        <span class="ql-formats">
                            <button type="button" class="ql-link"></button>
                        </span>
                    </ng-template>
                </p-editor>
            </div>

            <div class="form-field">
                <label for="effectiveDate">Effective Date *</label>
                <p-calendar 
                    id="effectiveDate" 
                    [(ngModel)]="currentTerm.effectiveDate"
                    [disabled]="isEditMode()"
                    [showIcon]="true"
                    dateFormat="mm/dd/yy">
                </p-calendar>
            </div>

            <div class="form-field">
                <label for="expiryDate">Expiry Date</label>
                <p-calendar 
                    id="expiryDate" 
                    [(ngModel)]="currentTerm.expiryDate"
                    [disabled]="isEditMode()"
                    [showIcon]="true"
                    dateFormat="mm/dd/yy">
                </p-calendar>
            </div>

            <div class="form-field full-width">
                <div class="checkbox-field">
                    <p-checkbox 
                        [(ngModel)]="currentTerm.isActive" 
                        [binary]="true"
                        [disabled]="isEditMode()"
                        inputId="isActive">
                    </p-checkbox>
                    <label for="isActive">Set as Active</label>
                </div>
            </div>
        </div>
    </div>

    <ng-template pTemplate="footer">
        <button 
            pButton 
            label="Close" 
            icon="pi pi-times" 
            class="p-button-text"
            (click)="cancel()">
        </button>
        <button 
            *ngIf="!isEditMode()"
            pButton 
            label="Save" 
            icon="pi pi-check" 
            class="p-button-primary"
            (click)="saveTerm()">
        </button>
    </ng-template>
</p-dialog>

<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>
